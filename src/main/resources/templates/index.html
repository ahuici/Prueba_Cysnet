<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>CiberCursos</title>
    <link rel="stylesheet" href="css/index.css">
    <link rel="icon" type="image/png" th:href="@{/images/iconoPagina.png}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <!-- TODO Falta el responsive-->
    <div th:insert="fragments/header :: header"></div>

    <div id="cursos"  class="card mt-5 ms-4 me-4 d-flex align-items-center justify-content-between flex-column flex-md-row animacion">
        <div class=" d-flex justify-content-center image-col">
            <img src="/images/imgCursos.png" alt="Imagen cursos"/>
        </div>
        <div class="ms-4 text-col">
            <p class="fs-5 text-justify">
                En CiberCursos tenemos una gran variedad de cursos sobre ciberseguridad. Hoy en día es muy importante la
                ciberseguridad, hay que proteger bien los datos, dispositivos
                y demas frente ataques cada vez mas elaborados. Desde CiberCursos ofrecemos cursos y certificaciones a
                buen precio y para todo tipo de niveles, desde principiantes hasta profesionales.
                Entre los cursos disponibles tenemos ciberseguridad básica, ciberseguridad avanzada, pentesting,
                phishing...
                Nuestros certificados tienen validez en toda España y cuenta con el respaldo de grandes empresas
                tecnologicas.
            </p>
            <div class="d-flex justify-content-center mt-4 mb-3">
                <button class="btn btn-primary mt-3" onclick="window.location.href='/cursos'">Ir a cursos</button>
            </div>
        </div>
    </div>

    <div id="certificaciones"  class="card mt-5 ms-4 me-4 d-flex align-items-center justify-content-between flex-column flex-md-row animacion">
        <div class="ms-4">
            <p class="fs-5 text-justify">
                CiberCursos tambien ofrece certificados al acabar los cursos. Estas certificaciones tienen validez
                en toda España y son reconocidas por grandes empresas. Estos certificados vienen incluidos en los cursos,
                aunque si crees que estas capacitado para certificarte sin hacer los cursos, puedes hacer el examen y
                conseguir la certificacion.
            </p>
            <div class=" d-flex justify-content-center mt-4 mb-3">
                <button class="btn btn-primary mt-3" disabled>Proximamente</button>
            </div>
        </div>
        <div class=" d-flex justify-content-center image-col">
            <img src="/images/imgCertificados.png" alt="Imagen certificaciones"/>
        </div>
    </div>

    <div id="formulario" class="container mt-5 mb-4 animacion">
        <div class="row justify-content-center">
            <div class="col-sm-8">
                <div class="card shadow p-4">

                    <h2 class="text-center mb-4 mt-2 text-primary">Inscripción</h2>

                    <form id="formularioInscripcion" action="#" th:action="@{/inscripcion}" th:object="${inscripcion}" method="post">

                        <div class="mb-3">
                            <label class="form-label" for="inpNombre">Nombre:</label>
                            <input id="inpNombre" type="text" class="form-control mt-1" th:field="*{nombre}" required/>
                        </div>

                        <div class="mb-3">
                            <label class="form-label " for="inpApellido">Apellido: </label>
                            <input id="inpApellido"  type="text" class="form-control" th:field="*{apellido}" required/>
                        </div>

                        <div class="mb-3">
                            <label class="form-label " for="inpTelefono">Telefono: </label>
                            <input id="inpTelefono"  type="text" class="form-control" th:field="*{numTelefono}" required placeholder=""/>
                        </div>

                        <div class="mb-3">
                            <label class="form-label " for="inpCorreo">Correo: </label>
                            <input id="inpCorreo"  type="email" class="form-control" th:field="*{email}" required/>
                        </div>

                        <div class="d-flex justify-content-center mt-4 mb-3">
                            <button type="submit" class="btn btn-primary w-33">Inscribirme</button>
                        </div>

                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="respuestaModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg rounded-4">
                <div class="modal-header bg-primary text-white rounded-top-4">
                    <h5 class="modal-title">Resultado de la inscripción</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body text-center py-4">
                    <p id="modalMensaje" class="fs-5"></p>
                </div>
                <div class="modal-footer justify-content-center border-0 mb-2">
                    <button type="button" class="btn btn-primary px-4" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <div th:insert="fragments/footer :: footer"></div>

    <!-- TODO Falta el responsive-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const sections = document.querySelectorAll(".animacion");

            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add("visible");
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.2 });

            sections.forEach(section => observer.observe(section));
        });


        document.getElementById("formularioInscripcion").addEventListener("submit", async e => {
          e.preventDefault();

            const form = e.target;
            const formData = new FormData(form);

            const res = await fetch(form.action, {
              method: form.method,
              body: JSON.stringify(Object.fromEntries(formData)),
              headers: { "Content-Type": "application/json" }
            });

            const mensaje = await res.text();

            const modalMensaje = document.getElementById("modalMensaje");
            modalMensaje.textContent = mensaje;

            // Opcional: colorear según éxito/error
            modalMensaje.className = res.ok ? "text-success fw-bold" : "text-danger fw-bold";

            // Mostrar el modal
            const modal = new bootstrap.Modal(document.getElementById('respuestaModal'));
            modal.show();

            if (res.ok) {
              document.getElementById("formularioInscripcion").reset();
            }
        });
    </script>
</body>
</html>